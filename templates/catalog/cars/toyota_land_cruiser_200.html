{% extends "base.html" %}

{% block title %}Toyota Land Cruiser 200 - CHI AUTO{% endblock %}

{% block content %}
<div class="car-detail-page">
    <!-- Кнопка назад -->
    <header class="detail-header">
        <button class="btn-back" onclick="history.back()">
            <i class='bx bx-arrow-back'></i>
        </button>
        <h1>Toyota Land Cruiser 200</h1>
        <div class="header-actions">
            <button class="btn-share" onclick="shareCar('toyota_land_cruiser_200')">
                <i class='bx bx-share-alt'></i>
            </button>
        </div>
    </header>

    <!-- Галерея изображений -->
    <section class="car-gallery">
        <div class="main-image">
            <img src="{{ url_for('static', filename='images/cars/toyota_land_cruiser_200_1.jpg') }}"
                 alt="Toyota Land Cruiser 200"
                 id="mainImage"
                 onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMWUzYThhIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxOCIgZmlsbD0iI2ZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPlRveW90YSBMYW5kIENydWlzZXIgMjAwPC90ZXh0Pjwvc3ZnPg=='">
        </div>
        <div class="image-thumbnails">
            <div class="thumbnail active" onclick="changeImage('{{ url_for(''static'', filename=''images/cars/toyota_land_cruiser_200_1.jpg'') }}', this)">
                <img src="{{ url_for('static', filename='images/cars/toyota_land_cruiser_200_1.jpg') }}"
                     alt="Toyota Land Cruiser 200 - вид спереди"
                     onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzFlM2E4YSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiNmZmYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIwLjNlbSI+MTwvdGV4dD48L3N2Zz4='">
            </div>
            <div class="thumbnail" onclick="changeImage('{{ url_for(''static'', filename=''images/cars/toyota_land_cruiser_200_2.jpg'') }}', this)">
                <img src="{{ url_for('static', filename='images/cars/toyota_land_cruiser_200_2.jpg') }}"
                     alt="Toyota Land Cruiser 200 - вид сбоку"
                     onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzFlM2E4YSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiNmZmYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIwLjNlbSI+MjwvdGV4dD48L3N2Zz4='">
            </div>
            <div class="thumbnail" onclick="changeImage('{{ url_for(''static'', filename=''images/cars/toyota_land_cruiser_200_3.jpg'') }}', this)">
                <img src="{{ url_for('static', filename='images/cars/toyota_land_cruiser_200_3.jpg') }}"
                     alt="Toyota Land Cruiser 200 - салон"
                     onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzFlM2E4YSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiNmZmYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIwLjNlbSI+MzwvdGV4dD48L3N2Zz4='">
            </div>
        </div>
    </section>

    <!-- Основная информация -->
    <section class="car-main-info">
        <div class="price-section">
            <div class="price-main">4 500 000 ₽</div>
            <div class="price-rental">
                <span>Аренда: 15 000 ₽/сутки</span>
                <span class="price-discount">от 10 дней: 12 000 ₽/сутки</span>
            </div>
        </div>

        <div class="availability-badge available">
            <i class='bx bx-check'></i>
            В наличии
        </div>
    </section>

    <!-- Характеристики -->
    <section class="car-specs-section">
        <h2 class="section-title">Характеристики</h2>
        <div class="specs-grid">
            <div class="spec-item">
                <div class="spec-icon">
                    <i class='bx bx-calendar'></i>
                </div>
                <div class="spec-info">
                    <span class="spec-label">Год выпуска</span>
                    <span class="spec-value">2015 г.</span>
                </div>
            </div>

            <div class="spec-item">
                <div class="spec-icon">
                    <i class='bx bx-chip'></i>
                </div>
                <div class="spec-info">
                    <span class="spec-label">Двигатель</span>
                    <span class="spec-value">4.6 л / 309 л.с. / Бензин</span>
                </div>
            </div>

            <div class="spec-item">
                <div class="spec-icon">
                    <i class='bx bx-cog'></i>
                </div>
                <div class="spec-info">
                    <span class="spec-label">Коробка передач</span>
                    <span class="spec-value">Автомат 6-ступ.</span>
                </div>
            </div>

            <div class="spec-item">
                <div class="spec-icon">
                    <i class='bx bx-tachometer'></i>
                </div>
                <div class="spec-info">
                    <span class="spec-label">Привод</span>
                    <span class="spec-value">Полный (4WD)</span>
                </div>
            </div>

            <div class="spec-item">
                <div class="spec-icon">
                    <i class='bx bx-gas-pump'></i>
                </div>
                <div class="spec-info">
                    <span class="spec-label">Расход топлива</span>
                    <span class="spec-value">14.5 л/100км</span>
                </div>
            </div>

            <div class="spec-item">
                <div class="spec-icon">
                    <i class='bx bx-bolt'></i>
                </div>
                <div class="spec-info">
                    <span class="spec-label">Разгон 0-100 км/ч</span>
                    <span class="spec-value">8.6 сек</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Описание -->
    <section class="car-description">
        <h2 class="section-title">Описание</h2>
        <div class="description-content">
            <p><strong>Toyota Land Cruiser 200</strong> - это легендарный внедорожник, сочетающий в себе непревзойденную проходимость, роскошь и надежность. Идеальный выбор для тех, кто ценит комфорт и уверенность на любой дороге.</p>

            <p>Автомобиль 2015 года в отличном техническом состоянии, полностью обслужен. Кузов без повреждений, салон в идеальном состоянии.</p>

            <p><strong>Преимущества:</strong></p>
            <ul>
                <li>Мощный 4.6-литровый бензиновый двигатель</li>
                <li>Постоянный полный привод</li>
                <li>Система помощи при спуске и подъеме</li>
                <li>Климат-контроль 4-зонный</li>
                <li>Кожаный салон с подогревом всех сидений</li>
                <li>Панорамная крыша</li>
                <li>Камера кругового обзора</li>
            </ul>
        </div>
    </section>

    <!-- Особенности -->
    <section class="car-features">
        <h2 class="section-title">Комплектация и опции</h2>
        <div class="features-grid">
            <div class="feature-item">
                <i class='bx bx-check'></i>
                <span>Кожаный салон</span>
            </div>
            <div class="feature-item">
                <i class='bx bx-check'></i>
                <span>Подогрев сидений</span>
            </div>
            <div class="feature-item">
                <i class='bx bx-check'></i>
                <span>Вентиляция сидений</span>
            </div>
            <div class="feature-item">
                <i class='bx bx-check'></i>
                <span>Панорамная крыша</span>
            </div>
            <div class="feature-item">
                <i class='bx bx-check'></i>
                <span>Камера 360°</span>
            </div>
            <div class="feature-item">
                <i class='bx bx-check'></i>
                <span>Парктроники</span>
            </div>
            <div class="feature-item">
                <i class='bx bx-check'></i>
                <span>Круиз-контроль</span>
            </div>
            <div class="feature-item">
                <i class='bx bx-check'></i>
                <span>Климат-контроль 4-зонный</span>
            </div>
            <div class="feature-item">
                <i class='bx bx-check'></i>
                <span>Мультимедиа с навигацией</span>
            </div>
            <div class="feature-item">
                <i class='bx bx-check'></i>
                <span>Светодиодная оптика</span>
            </div>
        </div>
    </section>

    <!-- Доступность по городам -->
    <section class="car-availability">
        <h2 class="section-title">Доступен в городах</h2>
        <div class="cities-list">
            <div class="city-availability-item" onclick="openPage('/city/irkutsk')">
                <div class="city-info">
                    <h4>Иркутск</h4>
                    <p>ул. Ленина, 1</p>
                </div>
                <div class="city-contact">
                    <span class="city-phone">+7 (3952) 123-456</span>
                    <i class='bx bx-chevron-right'></i>
                </div>
            </div>
            <div class="city-availability-item" onclick="openPage('/city/moscow')">
                <div class="city-info">
                    <h4>Москва</h4>
                    <p>ул. Тверская, 10</p>
                </div>
                <div class="city-contact">
                    <span class="city-phone">+7 (495) 123-4567</span>
                    <i class='bx bx-chevron-right'></i>
                </div>
            </div>
        </div>
    </section>

    <!-- Кнопки действий -->
    <section class="car-actions">
        <div class="action-buttons">
            <button class="btn-action primary large" onclick="openRentModal('toyota_land_cruiser_200', 'Toyota Land Cruiser 200')">
                <i class='bx bx-calendar'></i>
                Арендовать
            </button>
            <button class="btn-action secondary large" onclick="openContactModal('Toyota Land Cruiser 200')">
                <i class='bx bx-phone'></i>
                Консультация
            </button>
        </div>
    </section>
</div>

<!-- Модальное окно аренды -->
<div id="rentModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Аренда Toyota Land Cruiser 200</h3>
            <button class="modal-close" onclick="closeRentModal()">
                <i class='bx bx-x'></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="rent-car-info">
                <h4>Toyota Land Cruiser 200</h4>
                <div class="rent-prices">
                    <div class="rent-price-item">
                        <span>Сутки:</span>
                        <span>15 000 ₽</span>
                    </div>
                    <div class="rent-price-item discount">
                        <span>От 10 дней:</span>
                        <span>12 000 ₽/сутки</span>
                    </div>
                </div>
            </div>

            <form id="rentForm" class="rent-form">
                <div class="form-group">
                    <label for="rentName">Ваше имя</label>
                    <input type="text" id="rentName" required placeholder="Введите ваше имя">
                </div>

                <div class="form-group">
                    <label for="rentPhone">Телефон</label>
                    <input type="tel" id="rentPhone" required placeholder="+7 (___) ___-__-__">
                </div>

                <div class="form-group">
                    <label for="rentCity">Город</label>
                    <select id="rentCity" required>
                        <option value="">Выберите город</option>
                        <option value="irkutsk">Иркутск</option>
                        <option value="moscow">Москва</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="rentDates">Даты аренды</label>
                    <input type="text" id="rentDates" required placeholder="Выберите даты" readonly>
                </div>

                <div class="form-group">
                    <label for="rentComment">Комментарий</label>
                    <textarea id="rentComment" placeholder="Дополнительные пожелания..."></textarea>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn-action secondary" onclick="closeRentModal()">
                Отмена
            </button>
            <button type="submit" form="rentForm" class="btn-action primary">
                Отправить заявку
            </button>
        </div>
    </div>
</div>

<style>
/* Стили такие же как в car_detail.html */
.car-detail-page {
    padding-bottom: 100px;
}

.detail-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
    padding: 0 8px;
}

.detail-header h1 {
    font-size: 20px;
    font-weight: 700;
    color: #f8fafc;
    text-align: center;
    flex: 1;
    margin: 0 12px;
}

.btn-back, .btn-share {
    background: rgba(96, 165, 250, 0.2);
    border: 1px solid #60a5fa;
    color: #bfdbfe;
    width: 40px;
    height: 40px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.btn-back:hover, .btn-share:hover {
    background: rgba(96, 165, 250, 0.3);
    transform: translateY(-1px);
}

.car-gallery {
    margin-bottom: 20px;
}

.main-image {
    width: 100%;
    height: 250px;
    border-radius: 16px;
    overflow: hidden;
    margin-bottom: 12px;
}

.main-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.image-thumbnails {
    display: flex;
    gap: 8px;
    overflow-x: auto;
    padding: 8px 0;
}

.thumbnail {
    width: 80px;
    height: 60px;
    border-radius: 8px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.thumbnail.active {
    border-color: #60a5fa;
}

.thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.car-main-info {
    background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
    border: 1px solid #3730a3;
}

.price-section {
    margin-bottom: 16px;
}

.price-main {
    font-size: 28px;
    font-weight: 800;
    color: #86efac;
    margin-bottom: 8px;
}

.price-rental {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.price-rental span {
    font-size: 16px;
    color: #c7d2fe;
}

.price-discount {
    color: #bbf7d0 !important;
    font-size: 14px !important;
}

.availability-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 600;
    backdrop-filter: blur(10px);
}

.availability-badge.available {
    background: rgba(34, 197, 94, 0.2);
    color: #bbf7d0;
    border: 1px solid rgba(74, 222, 128, 0.4);
}

.car-specs-section {
    margin-bottom: 24px;
}

.specs-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 12px;
}

.spec-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
    border-radius: 12px;
    border: 1px solid #3730a3;
}

.spec-icon {
    width: 40px;
    height: 40px;
    background: rgba(96, 165, 250, 0.2);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid #60a5fa;
}

.spec-icon i {
    font-size: 20px;
    color: #60a5fa;
}

.spec-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.spec-label {
    font-size: 12px;
    color: #bfdbfe;
}

.spec-value {
    font-size: 14px;
    font-weight: 600;
    color: #f8fafc;
}

.car-description {
    margin-bottom: 24px;
}

.description-content {
    background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
    border-radius: 16px;
    padding: 20px;
    border: 1px solid #3730a3;
}

.description-content p {
    color: #e2e8f0;
    line-height: 1.6;
    margin-bottom: 12px;
}

.description-content ul {
    color: #e2e8f0;
    padding-left: 20px;
    margin-top: 10px;
}

.description-content li {
    margin-bottom: 6px;
    line-height: 1.4;
}

.car-features {
    margin-bottom: 24px;
}

.features-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 8px;
}

.feature-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
    border-radius: 12px;
    border: 1px solid #3730a3;
}

.feature-item i {
    color: #22c55e;
    font-size: 18px;
}

.feature-item span {
    color: #e2e8f0;
    font-size: 14px;
}

.car-availability {
    margin-bottom: 24px;
}

.cities-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.city-availability-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px;
    background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
    border-radius: 12px;
    border: 1px solid #3730a3;
    cursor: pointer;
    transition: all 0.3s ease;
}

.city-availability-item:hover {
    border-color: #60a5fa;
    transform: translateY(-1px);
}

.city-info h4 {
    font-size: 16px;
    font-weight: 600;
    color: #f8fafc;
    margin-bottom: 4px;
}

.city-info p {
    font-size: 12px;
    color: #bfdbfe;
}

.city-contact {
    display: flex;
    align-items: center;
    gap: 12px;
}

.city-phone {
    font-size: 14px;
    color: #60a5fa;
    font-weight: 500;
}

.city-contact i {
    color: #94a3b8;
    font-size: 20px;
}

.car-actions {
    position: fixed;
    bottom: 70px;
    left: 16px;
    right: 16px;
    background: #0a1128;
    padding: 16px 0;
    border-top: 1px solid #1e3a8a;
}

.action-buttons {
    display: flex;
    gap: 12px;
}

.btn-action.large {
    flex: 1;
    padding: 16px 20px;
    font-size: 16px;
    font-weight: 600;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.btn-action.primary {
    background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
    color: white;
}

.btn-action.secondary {
    background: rgba(96, 165, 250, 0.2);
    border: 1px solid #60a5fa;
    color: #bfdbfe;
}

.btn-action:not(:disabled):hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(96, 165, 250, 0.3);
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(10, 17, 40, 0.9);
    backdrop-filter: blur(5px);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.modal-content {
    background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
    border-radius: 20px;
    border: 1px solid #3730a3;
    width: 100%;
    max-width: 500px;
    max-height: 90vh;
    overflow-y: auto;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px;
    border-bottom: 1px solid #3730a3;
}

.modal-header h3 {
    font-size: 18px;
    font-weight: 600;
    color: #f8fafc;
}

.modal-close {
    background: none;
    border: none;
    color: #94a3b8;
    font-size: 24px;
    cursor: pointer;
    transition: color 0.3s ease;
}

.modal-close:hover {
    color: #f8fafc;
}

.modal-body {
    padding: 24px;
}

.modal-footer {
    display: flex;
    gap: 12px;
    padding: 20px 24px;
    border-top: 1px solid #3730a3;
}

@media (min-width: 768px) {
    .specs-grid {
        grid-template-columns: repeat(2, 1fr);
    }

    .features-grid {
        grid-template-columns: repeat(2, 1fr);
    }

    .detail-header h1 {
        font-size: 24px;
    }

    .main-image {
        height: 300px;
    }
}

@media (min-width: 1024px) {
    .specs-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}
</style>

<script>
// Функции для галереи
function changeImage(src, element) {
    document.getElementById('mainImage').src = src;

    // Убираем активный класс у всех миниатюр
    document.querySelectorAll('.thumbnail').forEach(thumb => {
        thumb.classList.remove('active');
    });

    // Добавляем активный класс к выбранной миниатюре
    element.classList.add('active');
}

// Функции для модального окна аренды
function openRentModal(carId, carName) {
    const modal = document.getElementById('rentModal');
    modal.style.display = 'flex';
}

function closeRentModal() {
    document.getElementById('rentModal').style.display = 'none';
}

function openContactModal(carName) {
    if (typeof Telegram !== 'undefined') {
        const tg = window.Telegram.WebApp;
        const message = `Здравствуйте! Интересует консультация по автомобилю: ${carName}`;
        tg.openTelegramLink(`https://t.me/chiauto_contact_bot?start=${encodeURIComponent(message)}`);
    } else {
        alert('Для консультации перейдите в наш Telegram: @chiauto_contact_bot');
    }
}

function shareCar(carId) {
    const carUrl = window.location.href;
    if (navigator.share) {
        navigator.share({
            title: 'Toyota Land Cruiser 200 - CHI AUTO',
            text: 'Посмотрите этот автомобиль в CHI AUTO',
            url: carUrl
        });
    } else {
        alert('Ссылка на автомобиль скопирована в буфер обмена');
        navigator.clipboard.writeText(carUrl);
    }
}

// Обработчик формы аренды
document.getElementById('rentForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const formData = {
        carName: 'Toyota Land Cruiser 200',
        name: document.getElementById('rentName').value,
        phone: document.getElementById('rentPhone').value,
        city: document.getElementById('rentCity').value,
        dates: document.getElementById('rentDates').value,
        comment: document.getElementById('rentComment').value
    };

    // Здесь можно отправить данные на сервер
    console.log('Rent form submitted:', formData);

    alert('Заявка на аренду отправлена! Мы свяжемся с вами в ближайшее время.');
    closeRentModal();
    this.reset();
});

// Закрытие модального окна при клике вне его
document.addEventListener('click', function(e) {
    const modal = document.getElementById('rentModal');
    if (e.target === modal) {
        closeRentModal();
    }
});

// Закрытие при нажатии ESC
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeRentModal();
    }
});
</script>
{% endblock %}